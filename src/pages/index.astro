---
import BaseLayout from '../layouts/BaseLayout.astro';
import Hero from '../components/Hero.astro';
import FeatureSection from '../components/FeatureSection.astro';
import CTASection from '../components/CTASection.astro';
import landing from '../content/landing.json';

// Make TS happy even if JSON typing is unknown.
type FeatureItem = {
  type: 'feature';
  theme?: 'dark' | 'light';
  kicker?: string;
  heading: string;
  body?: string;
  image: string;
  imageSide?: 'left' | 'right';
};
type CtaItem = {
  type: 'cta';
  theme?: 'dark' | 'light';
  heading: string;
  primaryCta?: { label: string; href: string };
  secondaryCta?: { label: string; href: string };
};
type SectionItem = FeatureItem | CtaItem;

const hero = (landing as any).hero ?? {};
const sections: SectionItem[] = Array.isArray((landing as any).sections)
  ? (landing as any).sections
  : [];
---
<BaseLayout>
  <Hero {...hero} />

  {sections.map((s) => {
    if (s.type === 'feature') {
      return (
        <FeatureSection
          theme={s.theme}
          kicker={s.kicker}
          heading={s.heading}
          body={s.body}
          image={s.image}
          imageSide={s.imageSide}
        />
      );
    }
    if (s.type === 'cta') {
      return (
        <CTASection
          theme={s.theme}
          heading={s.heading}
          primaryCta={s.primaryCta}
          secondaryCta={s.secondaryCta}
        />
      );
    }
    return null;
  })}
</BaseLayout>
